# Migration `20201004110208`

This migration has been generated by Iddan Aaronsohn at 10/4/2020, 2:02:08 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
ALTER TABLE "public"."App" ADD COLUMN "color" text   NOT NULL DEFAULT E'#20A4F3'
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200917163133..20201004110208
--- datamodel.dml
+++ datamodel.dml
@@ -1,7 +1,7 @@
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url = "***"
 }
 generator client {
   provider        = "prisma-client-js"
@@ -14,9 +14,9 @@
 //   output   = "./dal"
 // }
 model Account {
-  id            String   @default(cuid()) @id
+  id            String   @id @default(cuid())
   createdAt     DateTime @default(now())
   updatedAt     DateTime @updatedAt
   email         String   @unique
   firstName     String
@@ -28,9 +28,9 @@
   githubId      String?
 }
 model Organization {
-  id              String   @default(cuid()) @id
+  id              String   @id @default(cuid())
   createdAt       DateTime @default(now())
   updatedAt       DateTime @updatedAt
   name            String   @unique
   defaultTimeZone String
@@ -39,9 +39,9 @@
   users           User[]
 }
 model User {
-  id                String       @default(cuid()) @id
+  id                String       @id @default(cuid())
   createdAt         DateTime     @default(now())
   updatedAt         DateTime     @updatedAt
   account           Account      @relation("AccountOnUser", fields: [accountId], references: [id])
   accountId         String
@@ -49,16 +49,16 @@
   organizationId    String
   userRoles         UserRole[]
   assignedCurrentTo Account?
-  @@unique([accountId, organizationId])
   commits       Commit[]
   lockedEntitis Entity[]
   builds        Build[]
+  @@unique([accountId, organizationId])
 }
 model UserRole {
-  id        String   @default(cuid()) @id
+  id        String   @id @default(cuid())
   createdAt DateTime @default(now())
   updatedAt DateTime @updatedAt
   user      User     @relation(fields: [userId], references: [id])
   userId    String
@@ -67,15 +67,16 @@
   @@unique([userId, role])
 }
 model App {
-  id             String       @default(cuid()) @id
+  id             String       @id @default(cuid())
   createdAt      DateTime     @default(now())
   updatedAt      DateTime     @updatedAt
   organization   Organization @relation(fields: [organizationId], references: [id])
   organizationId String
   name           String
   description    String
+  color          String       @default("#20A4F3")
   entities       Entity[]
   blocks         Block[]
   roles          AppRole[]
   commits        Commit[]
@@ -84,24 +85,24 @@
   @@unique([organizationId, name])
 }
 model AppRole {
-  id          String   @default(cuid()) @id
+  id          String   @id @default(cuid())
   createdAt   DateTime @default(now())
   updatedAt   DateTime @updatedAt
   app         App      @relation(fields: [appId], references: [id])
   appId       String
   name        String
   displayName String
   description String?
+  entityPermissionRoles EntityPermissionRole[]
   @@unique([appId, name])
   @@unique([appId, displayName])
-  entityPermissionRoles EntityPermissionRole[]
 }
 model Commit {
-  id        String   @default(cuid()) @id
+  id        String   @id @default(cuid())
   createdAt DateTime @default(now())
   app       App      @relation(fields: [appId], references: [id])
   appId     String
   user      User     @relation(fields: [userId], references: [id])
@@ -111,9 +112,9 @@
   entityVersions EntityVersion[]
 }
 model Entity {
-  id                String          @default(cuid()) @id
+  id                String          @id @default(cuid())
   createdAt         DateTime        @default(now())
   updatedAt         DateTime        @updatedAt
   app               App             @relation(fields: [appId], references: [id])
   appId             String
@@ -132,9 +133,9 @@
   @@unique([appId, displayName])
 }
 model EntityVersion {
-  id                String             @default(cuid()) @id
+  id                String             @id @default(cuid())
   createdAt         DateTime           @default(now())
   updatedAt         DateTime           @updatedAt
   entity            Entity             @relation(fields: [entityId], references: [id])
   entityId          String
@@ -149,10 +150,10 @@
   permissions       EntityPermission[]
   builds            Build[]            @relation(references: [id])
   deleted           Boolean?
+
   @@unique([entityId, versionNumber])
-
 }
 enum EnumEntityAction {
   View
@@ -168,32 +169,33 @@
   Disabled
 }
 model EntityPermission {
-  id               String                   @default(cuid()) @id
+  id               String                   @id @default(cuid())
   entityVersion    EntityVersion            @relation(fields: [entityVersionId], references: [id])
   entityVersionId  String
   action           EnumEntityAction
   type             EnumEntityPermissionType
   permissionRoles  EntityPermissionRole[]
   permissionFields EntityPermissionField[]
+
   @@unique([entityVersionId, action])
 }
 model EntityPermissionRole {
-  id               String                  @default(cuid()) @id
+  id               String                  @id @default(cuid())
   permission       EntityPermission        @relation(fields: [entityVersionId, action], references: [entityVersionId, action])
   entityVersionId  String
   action           EnumEntityAction
   appRole          AppRole                 @relation(fields: [appRoleId], references: [id])
   appRoleId        String
   permissionFields EntityPermissionField[]
+
   @@unique([entityVersionId, action, appRoleId])
-
 }
 model EntityPermissionField {
-  id               String                 @default(cuid()) @id
+  id               String                 @id @default(cuid())
   permission       EntityPermission       @relation(fields: [permissionId], references: [id])
   permissionId     String
   field            EntityField            @relation(fields: [fieldPermanentId, entityVersionId], references: [permanentId, entityVersionId])
   fieldPermanentId String
@@ -203,9 +205,9 @@
   @@unique([permissionId, fieldPermanentId])
 }
 model EntityField {
-  id              String        @default(cuid()) @id
+  id              String        @id @default(cuid())
   createdAt       DateTime      @default(now())
   updatedAt       DateTime      @updatedAt
   entityVersion   EntityVersion @relation(fields: [entityVersionId], references: [id])
   entityVersionId String
@@ -219,12 +221,12 @@
   searchable      Boolean
   description     String
   position        Int?
+  permissionField EntityPermissionField[]
   @@unique([entityVersionId, permanentId])
   @@unique([entityVersionId, name])
   @@unique([entityVersionId, displayName])
-  permissionField EntityPermissionField[]
 }
 enum EnumDataType {
   SingleLineText
@@ -244,9 +246,9 @@
   UpdatedAt
 }
 model Block {
-  id            String         @default(cuid()) @id
+  id            String         @id @default(cuid())
   createdAt     DateTime       @default(now())
   updatedAt     DateTime       @updatedAt
   app           App            @relation(fields: [appId], references: [id])
   appId         String
@@ -256,10 +258,10 @@
   displayName   String
   description   String?
   versions      BlockVersion[]
+  blocks Block[] @relation("BlockToBlock")
   @@unique([appId, displayName])
-  blocks Block[] @relation("BlockToBlock")
 }
 enum EnumBlockType {
   AppSettings
@@ -277,9 +279,9 @@
   Document
 }
 model BlockVersion {
-  id               String   @default(cuid()) @id
+  id               String   @id @default(cuid())
   createdAt        DateTime @default(now())
   updatedAt        DateTime @updatedAt
   block            Block    @relation(fields: [blockId], references: [id])
   blockId          String
@@ -300,16 +302,16 @@
   Success
 }
 model Action {
-  id        String       @default(cuid()) @id
+  id        String       @id @default(cuid())
   createdAt DateTime     @default(now())
   steps     ActionStep[]
   builds    Build[]
 }
 model ActionStep {
-  id          String           @default(cuid()) @id
+  id          String           @id @default(cuid())
   createdAt   DateTime         @default(now())
   message     String
   status      ActionStepStatus
   completedAt DateTime?
@@ -325,9 +327,9 @@
   Debug
 }
 model ActionLog {
-  id        String       @default(cuid()) @id
+  id        String       @id @default(cuid())
   createdAt DateTime     @default(now())
   message   String
   meta      Json
   level     EnumLogLevel
@@ -344,9 +346,9 @@
   Paused
 }
 model Build {
-  id             String          @default(cuid()) @id
+  id             String          @id @default(cuid())
   createdAt      DateTime        @default(now())
   createdBy      User            @relation(fields: [userId], references: [id])
   app            App             @relation(fields: [appId], references: [id])
   appId          String
```


