datasource sqlite {
  provider = "sqlite"
  url = "***"
  enabled  = false
}

datasource db {
  provider = "postgresql"
  url = "***"
  enabled  = true
}

generator client {
  provider = "prisma-client-js"
}

model User {
  id        String   @default(cuid()) @id
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  email     String   @unique
  password  String
  firstname String?
  lastname  String?
  posts     Post[]
  role      Role
}

model Post {
  id        String   @default(cuid()) @id
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  published Boolean
  title     String
  content   String?
  author    User?
}

enum Role {
  ADMIN
  USER
}

model Organization {
  id    String   @default(cuid()) @id
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  name  String
  defaultTimeZone String
  environments  Environment[]
}

model Environment {
  id    String   @default(cuid()) @id
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  organization Organization
  name  String 
  defaultTimeZone String
  entity  Entity[]
  
  //@@index([organization])
}

model Entity {
  id    String   @default(cuid()) @id
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  environment Environment
  name  String
  displayName String
  pluralDisplayName String
  description String
  isPersistent  Boolean
  allowFeedback Boolean // TBC
  primaryField  String
  entityFields  EntityField[]
}

model EntityField {
  id    String   @default(cuid()) @id
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  entity Entity
  name  String
  displayName String
  dataType  EnumDataType
  dataTypeProperties  String // JSON representation of the properties that relates based on selected type of field
  properties  String
  required  Boolean // TBD
  searchable  Boolean // TBD
  description String // TBD
}

enum EnumDataType {
  Text
  AutoNumber
  WholeNumber
  TimeZone
  Language
  DateAndTime
  Currancy
  DecimalNumber
  File
  Image
  Lookup
  CustomEntity
  OptionSet
  Boolean
  Color
  Guid
  Time
  CalculatedField
  RollupField
}



