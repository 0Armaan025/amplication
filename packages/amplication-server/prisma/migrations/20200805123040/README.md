# Migration `20200805123040`

This migration has been generated by Yuval Hazaz at 8/5/2020, 12:30:41 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "public"."Commit" (
"appId" text  NOT NULL ,"createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,"id" text  NOT NULL ,"message" text  NOT NULL ,"userId" text  NOT NULL ,
    PRIMARY KEY ("id"))

ALTER TABLE "public"."Commit" ADD FOREIGN KEY ("appId")REFERENCES "public"."App"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."Commit" ADD FOREIGN KEY ("userId")REFERENCES "public"."User"("id") ON DELETE CASCADE  ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200804115527..20200805123040
--- datamodel.dml
+++ datamodel.dml
@@ -1,7 +1,7 @@
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url      = env("POSTGRESQL_URL")
   enabled  = true
 }
 generator client {
@@ -48,8 +48,9 @@
   userRoles      UserRole[]
   Account        Account[]
   @@unique([accountId, organizationId])
+  commits Commit[]
 }
 // enum Role {
 // ADMIN
@@ -80,8 +81,9 @@
   Block          Block[]
   @@unique([organizationId, name])
   AppRole AppRole[]
+  commits Commit[]
 }
 model AppRole {
   id          String   @default(cuid()) @id
@@ -97,8 +99,19 @@
   @@unique([appId, displayName])
   entityPermissions EntityPermission[]
 }
+model Commit {
+  id        String   @default(cuid()) @id
+  createdAt DateTime @default(now())
+  app       App      @relation(fields: [appId], references: [id])
+  appId     String
+  user      User     @relation(fields: [userId], references: [id])
+  userId    String
+  message   String
+
+}
+
 model Entity {
   id                String          @default(cuid()) @id
   createdAt         DateTime        @default(now())
   updatedAt         DateTime        @updatedAt
@@ -129,10 +142,10 @@
   label         String
   entityFields  EntityField[]
   @@unique([entityId, versionNumber])
+  entityPermissions EntityPermission[]
-  entityPermissions EntityPermission[]
 }
 enum EnumEntityAction {
   View
@@ -148,10 +161,10 @@
   action          EnumEntityAction
   appRole         AppRole          @relation(fields: [appRoleId], references: [id])
   appRoleId       String
+
   @@id([entityVersionId, action, appRoleId])
-
 }
 model EntityField {
   id               String        @default(cuid()) @id
```


