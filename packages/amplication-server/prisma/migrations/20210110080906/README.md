# Migration `20210110080906`

This migration has been generated by Yuval Hazaz at 1/10/2021, 10:09:07 AM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
ALTER TABLE "App" ADD COLUMN     "githubToken" TEXT,
ADD COLUMN     "githubTokenCreatedDate" TIMESTAMP(3),
ADD COLUMN     "githubSyncEnabled" BOOLEAN NOT NULL DEFAULT false,
ADD COLUMN     "githubRepo" TEXT,
ADD COLUMN     "githubBranch" TEXT,
ADD COLUMN     "githubLastSync" TIMESTAMP(3),
ADD COLUMN     "githubLastMessage" TEXT

ALTER TABLE "Release" ALTER COLUMN "commitId" SET NOT NULL
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20201115151445-release-model..20210110080906
--- datamodel.dml
+++ datamodel.dml
@@ -1,7 +1,7 @@
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url = "***"
 }
 generator client {
   provider = "prisma-client-js"
@@ -67,21 +67,28 @@
   @@unique([userId, role])
 }
 model App {
-  id             String       @id @default(cuid())
-  createdAt      DateTime     @default(now())
-  updatedAt      DateTime     @updatedAt
-  organization   Organization @relation(fields: [organizationId], references: [id])
-  organizationId String
-  name           String
-  description    String
-  color          String       @default("#20A4F3")
-  entities       Entity[]
-  blocks         Block[]
-  roles          AppRole[]
-  commits        Commit[]
-  builds         Build[]
+  id                     String       @id @default(cuid())
+  createdAt              DateTime     @default(now())
+  updatedAt              DateTime     @updatedAt
+  organization           Organization @relation(fields: [organizationId], references: [id])
+  organizationId         String
+  name                   String
+  description            String
+  color                  String       @default("#20A4F3")
+  githubToken            String?
+  githubTokenCreatedDate DateTime?
+  githubSyncEnabled      Boolean      @default(false)
+  githubRepo             String?
+  githubBranch           String?
+  githubLastSync         DateTime?
+  githubLastMessage      String?
+  entities               Entity[]
+  blocks                 Block[]
+  roles                  AppRole[]
+  commits                Commit[]
+  builds                 Build[]
   environments Environment[]
   @@unique([organizationId, name])
 }
@@ -110,8 +117,10 @@
   userId    String
   message   String
   entityVersions EntityVersion[]
+  builds         Build[]
+  releases       Release[]
 }
 model Entity {
   id                String          @id @default(cuid())
@@ -357,26 +366,25 @@
   actionId                 String
   images                   String[]
   containerStatusQuery     Json?
   containerStatusUpdatedAt DateTime?
-  commit            Commit?            @relation(fields: [commitId], references: [id])
-  commitId          String?
+  commit                   Commit?         @relation(fields: [commitId], references: [id])
+  commitId                 String?
   deployments Deployment[]
   @@unique([appId, version])
 }
 model Release {
   id          String   @id @default(cuid())
   createdAt   DateTime @default(now())
-  version                  String
+  version     String
   description String?
-  commit            Commit?            @relation(fields: [commitId], references: [id])
-  commitId          String?
+  commit      Commit   @relation(fields: [commitId], references: [id])
+  commitId    String
 }
-
 model Environment {
   id          String   @id @default(cuid())
   createdAt   DateTime @default(now())
   updatedAt   DateTime @default(now())
```


