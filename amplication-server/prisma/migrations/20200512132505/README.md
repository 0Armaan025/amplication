# Migration `20200512132505`

This migration has been generated by Yuval Hazaz at 5/12/2020, 1:25:05 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "public"."App" (
    "createdAt" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00',
    "description" text  NOT NULL DEFAULT '',
    "id" text  NOT NULL ,
    "name" text  NOT NULL DEFAULT '',
    "organization" text  NOT NULL ,
    "updatedAt" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00',
    PRIMARY KEY ("id")
)

ALTER TABLE "public"."Account" ADD COLUMN "currentUser" text   ;

ALTER TABLE "public"."Entity" DROP CONSTRAINT IF EXiSTS "Entity_project_fkey",
DROP COLUMN "project",
ADD COLUMN "app" text  NOT NULL ;

ALTER TABLE "public"."App" ADD FOREIGN KEY ("organization")REFERENCES "public"."Organization"("id") ON DELETE RESTRICT  ON UPDATE CASCADE

ALTER TABLE "public"."Account" ADD FOREIGN KEY ("currentUser")REFERENCES "public"."User"("id") ON DELETE SET NULL  ON UPDATE CASCADE

ALTER TABLE "public"."Entity" ADD FOREIGN KEY ("app")REFERENCES "public"."App"("id") ON DELETE RESTRICT  ON UPDATE CASCADE

DROP TABLE "public"."Project";
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200323133235..20200512132505
--- datamodel.dml
+++ datamodel.dml
@@ -1,13 +1,13 @@
 datasource sqlite {
   provider = "sqlite"
-  url = "***"
+  url      = "file:./dev.db"
   enabled  = false
 }
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url      = env("POSTGRESQL_URL")
   enabled  = true
 }
 generator client {
@@ -27,8 +27,9 @@
   firstName String
   lastName String
   password  String
   users  User[]
+  currentUser User? @relation("CurrentUser")
 }
@@ -39,9 +40,9 @@
   updatedAt DateTime @updatedAt
   name  String
   defaultTimeZone String
   address String
-  projects  Project[]
+  apps  App[]
   users User[]
 }
@@ -72,24 +73,23 @@
   role String
 }
-
-model Project {
+model App {
   id    String   @default(cuid()) @id
   createdAt DateTime @default(now())
   updatedAt DateTime @updatedAt
   organization Organization
   name  String
+  description String
   entity  Entity[]
-  //@@index([organization])
 }
 model Entity {
   id    String   @default(cuid()) @id
   createdAt DateTime @default(now())
   updatedAt DateTime @updatedAt
-  project  Project
+  app  App
   name  String
   displayName String
   pluralDisplayName String
   description String
```
